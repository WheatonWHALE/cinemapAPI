<!DOCTYPE html>
<html>
    <head>
        <title>CineMap </title>
        <script src='https://api.tiles.mapbox.com/mapbox.js/v1.6.3/mapbox.js'></script>
        <link href='https://api.tiles.mapbox.com/mapbox.js/v1.6.3/mapbox.css' rel='stylesheet' />
        <script src="js/Chart.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
        <style>
            #map {
                height: 500px;
                width: 800px;
                margin: auto;
            }

            #showtimes {
				margin: auto;
			}

			.headline {
				height: 100px;
				line-height: 100px;
				width: 300px;
				font-size: 64px;
				text-align: center;
				margin: auto;
			}

			.container {
				margin: auto;
				width: 800px;
			}
        </style>
    </head>
    <body>
    	<div class="container">
	    	<div class="headline">CineMap</div>
	        <div id="showtimes"><canvas id="line" data-type="Line"></canvas></div>
	        <div id="map"></div>
       	</div>

        <script>
            var map = L.mapbox.map('map', 'examples.map-i86nkdio').setView([41.94723, -71.18866], 3);

            function addMarker(venue) {
                L.marker([venue.geocode.latitude, venue.geocode.longitude],
                        {
                            icon: L.mapbox.marker.icon({
                                'marker-color': '#f86767'
                            })
                        }).addTo(map)
                        .bindPopup("<b>" + venue.name + "</b><br>" + venue.address.street + "<br>" + venue.address.city + ", " + venue.address.state);
            }


            $(document).ready(function(){
                $.getJSON("http://infinite-citadel-8572.herokuapp.com/api/0.1/venues?address.state=MA", function(json) {
                    for (var i = 0; i < json.length; i++) {
                        addMarker(json[i]);
                    }
                });
            });

            var popup = L.popup();

            function onMapClick(e) {
                popup
                    .setLatLng(e.latlng)
                    .setContent("You clicked the map at " + e.latlng.toString())
                    .openOn(map);
            }

            map.on('click', onMapClick);  
        </script>



        <script type="text/javascript">
	        $(document).ready(function(){
	        	var data = {
	        		labels: [],
	        		datasets: [{
							fillColor : "rgba(151,187,205,0.5)",
							strokeColor : "rgba(151,187,205,1)",
							pointColor : "rgba(151,187,205,1)",
							pointStrokeColor : "#eee",
							data : []
	        			}]
	        		};
                $.getJSON("http://infinite-citadel-8572.herokuapp.com/api/0.1/counts/states", function(json) {
                    for (var i = 0; i < json.length; i++) {
                    	data.labels.push(json[i]["_id"]);
                    	data.datasets[0].data.push(json[i]["count"]);
                    }

        			//Get context with jQuery - using jQuery's .get() method.
					var ctx = $("#line").get(0).getContext("2d");
					$("#line").get(0).setAttribute('width', '800');
					$("#line").get(0).setAttribute('height', '600');
					//This will get the first returned node in the jQuery collection.
					var myNewChart = new Chart(ctx).Radar(data);	
                });
            });
        	

			// var data = {
			// 	labels : ["AL", "AK", "AS", "AZ", "AR", "CA", "CO", "CT", "DE", "DC", "FM", "FL", "GA", "GU", "HI", "ID", "IL", "IN", "IA", "KS", "KY", "LA", "ME", "MH", "MD", "MA", "MI", "MN", "MS", "MO", "MT", "NE", "NV", "NH", "NJ", "NM", "NY", "NC", "ND", "MP", "OH", "OK", "OR", "PW", "PA", "PR", "RI", "SC", "SD", "TN", "TX", "UT", "VT", "VI", "VA", "WA", "WV", "WI", "WY"],
			// 	datasets : [
			// 		{
			// 			fillColor : "rgba(220,220,220,0.5)",
			// 			strokeColor : "rgba(220,220,220,1)",
			// 			pointColor : "rgba(220,220,220,1)",
			// 			pointStrokeColor : "#fff",
			// 			data : [65,59,90,81,56,55,40]
			// 		},
			// 		{
			// 			fillColor : "rgba(151,187,205,0.5)",
			// 			strokeColor : "rgba(151,187,205,1)",
			// 			pointColor : "rgba(151,187,205,1)",
			// 			pointStrokeColor : "#fff",
			// 			data : [28,48,40,19,96,27,100]
			// 		},
			// 		{
			// 			fillColor : "rgba(100,167,185,0.5)",
			// 			strokeColor : "rgba(151,187,205,1)",
			// 			pointColor : "rgba(151,187,205,1)",
			// 			pointStrokeColor : "#fff",
			// 			data : [2,4,10,19,196,127,200]
			// 		}

			// 	]
			// };




			//Get context with jQuery - using jQuery's .get() method.
			// var ctx = $("#line").get(0).getContext("2d");
			// $("#line").get(0).setAttribute('width', '1400');
			// $("#line").get(0).setAttribute('height', '600');
			// //This will get the first returned node in the jQuery collection.
			// var myNewChart = new Chart(ctx).Bar(data);			

			// myNewChart.defaults = {
							
			// 	//Boolean - If we show the scale above the chart data			
			// 	scaleOverlay : false,
				
			// 	//Boolean - If we want to override with a hard coded scale
			// 	scaleOverride : false,
				
			// 	//** Required if scaleOverride is true **
			// 	//Number - The number of steps in a hard coded scale
			// 	scaleSteps : null,
			// 	//Number - The value jump in the hard coded scale
			// 	scaleStepWidth : null,
			// 	//Number - The scale starting value
			// 	scaleStartValue : null,

			// 	//String - Colour of the scale line	
			// 	scaleLineColor : "rgba(0,0,0,.1)",
				
			// 	//Number - Pixel width of the scale line	
			// 	scaleLineWidth : 1,

			// 	//Boolean - Whether to show labels on the scale	
			// 	scaleShowLabels : true,
				
			// 	//Interpolated JS string - can access value
			// 	scaleLabel : "<%=value%>",
				
			// 	//String - Scale label font declaration for the scale label
			// 	scaleFontFamily : "'Arial'",
				
			// 	//Number - Scale label font size in pixels	
			// 	scaleFontSize : 12,
				
			// 	//String - Scale label font weight style	
			// 	scaleFontStyle : "normal",
				
			// 	//String - Scale label font colour	
			// 	scaleFontColor : "#666",	
				
			// 	///Boolean - Whether grid lines are shown across the chart
			// 	scaleShowGridLines : true,
				
			// 	//String - Colour of the grid lines
			// 	scaleGridLineColor : "rgba(0,0,0,.05)",
				
			// 	//Number - Width of the grid lines
			// 	scaleGridLineWidth : 1,	
				
			// 	//Boolean - Whether the line is curved between points
			// 	bezierCurve : true,
				
			// 	//Boolean - Whether to show a dot for each point
			// 	pointDot : true,
				
			// 	//Number - Radius of each point dot in pixels
			// 	pointDotRadius : 3,
				
			// 	//Number - Pixel width of point dot stroke
			// 	pointDotStrokeWidth : 1,
				
			// 	//Boolean - Whether to show a stroke for datasets
			// 	datasetStroke : true,
				
			// 	//Number - Pixel width of dataset stroke
			// 	datasetStrokeWidth : 2,
				
			// 	//Boolean - Whether to fill the dataset with a colour
			// 	datasetFill : true,
				
			// 	//Boolean - Whether to animate the chart
			// 	animation : true,

			// 	//Number - Number of animation steps
			// 	animationSteps : 60,
				
			// 	//String - Animation easing effect
			// 	animationEasing : "easeOutQuart",

			// 	//Function - Fires when the animation is complete
			// 	onAnimationComplete : null
			// };

        </script>
    </body>
</html>